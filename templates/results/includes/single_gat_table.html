{% if test %}
<div class="p-4 border-b bg-gray-50 text-sm text-gray-600">
    <strong>Тест:</strong> {{ test.name }} (от {{ test.test_date|date:"d.m.Y" }})
</div>
{% endif %}
<table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50">
        <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Место</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ф.И.О</th>
            <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">Балл {{ gat_name }}</th>
        </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
        {% for data in students_data %}
        <tr class="hover:bg-gray-50">
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ forloop.counter }}</td>
            
            {# --- ИЗМЕНЕНИЕ ЗДЕСЬ --- #}
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                 <a href="{% url 'student_progress' data.student.id %}" class="text-indigo-600 hover:text-indigo-800 hover:underline">
                    {{ data.student.last_name }} {{ data.student.first_name }}
                </a>
            </td>
            {# --- КОНЕЦ ИЗМЕНЕНИЯ --- #}

            <td class="px-6 py-4 whitespace-nowrap text-sm text-center font-bold {% if data.score is None %}text-red-500{% else %}text-gray-800{% endif %}">
                {{ data.score|default:"—" }}
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="3" class="px-6 py-4 text-center text-gray-500">Нет данных для отображения.</td></tr>
        {% endfor %}
    </tbody>
</table>