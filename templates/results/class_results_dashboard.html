{% extends 'base.html' %}
{% load custom_filters %}

{% block content %}

{# Ваш блок с заголовком, он выглядит отлично #}
<div class="mb-6">
    <a href="{% url 'archive_classes' quarter_id=quarter.id school_id=school_class.school.id %}" class="text-indigo-600 hover:underline mb-4 inline-block">&larr; Назад к классам</a>
    
    <h1 class="text-3xl font-bold text-gray-800">Класс: {{ school_class.name }}</h1>
    <div class="mt-2 text-sm text-gray-500">
        <p>Четверть: {{ quarter }}</p>
        <p>Школа: {{ school_class.school.name }}</p>
    </div>
</div>

{# Alpine.js для управления вкладками #}
<div x-data="{ activeTab: 'total' }">
    {# Навигация по вкладкам #}
    <div class="border-b border-gray-200 mb-6">
        <nav class="-mb-px flex space-x-6" aria-label="Tabs">
            <button @click="activeTab = 'total'"
                    :class="{ 'border-indigo-500 text-indigo-600': activeTab === 'total', 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'total' }"
                    class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                Итоговый рейтинг
            </button>
            <button @click="activeTab = 'gat1'"
                    :class="{ 'border-indigo-500 text-indigo-600': activeTab === 'gat1', 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'gat1' }"
                    class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                GAT-1
            </button>
            <button @click="activeTab = 'gat2'"
                    :class="{ 'border-indigo-500 text-indigo-600': activeTab === 'gat2', 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'gat2' }"
                    class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                GAT-2
            </button>
        </nav>
    </div>

    {# Содержимое вкладок #}
    <div class="bg-white shadow-md rounded-lg overflow-x-auto">
        
        {# --- ИЗМЕНЕНИЕ: Убран style="display: none;" --- #}
        <div x-show="activeTab === 'total'">
            {% include 'results/includes/total_table.html' with students_data=students_data_total %}
        </div>

        {# --- ИЗМЕНЕНИЕ: Убран style="display: none;" --- #}
        <div x-show="activeTab === 'gat1'">
            {% if test_gat1 %}
                {% include 'results/includes/detailed_table.html' with students_data=students_data_gat1 table_header=table_header_gat1 %}
            {% else %}
                 <p class="p-6 text-center text-gray-500">Нет данных для GAT-1 в этой четверти.</p>
            {% endif %}
        </div>

        {# --- ИЗМЕНЕНИЕ: Убран style="display: none;" --- #}
        <div x-show="activeTab === 'gat2'">
            {% if test_gat2 %}
                {% include 'results/includes/detailed_table.html' with students_data=students_data_gat2 table_header=table_header_gat2 %}
            {% else %}
                <p class="p-6 text-center text-gray-500">Нет данных для GAT-2 в этой четверти.</p>
            {% endif %}
        </div>
        
    </div>
</div>
{% endblock %}